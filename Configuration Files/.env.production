# .env.production - Production Environment Configuration
# Copy this file to .env and fill in your actual values

# ======================
# APPLICATION SETTINGS
# ======================
ENVIRONMENT=production
DEBUG=False
SECRET_KEY=your-super-secret-key-change-this-in-production
APP_NAME=TapsiFood Dashboard
APP_VERSION=2.0.0

# ======================
# DATABASE CONFIGURATION
# ======================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=tapsifood_dashboard
DB_USER=dashboard_user
DB_PASSWORD=your-secure-database-password
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# Database connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_RECYCLE=3600

# ======================
# REDIS CONFIGURATION
# ======================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis memory settings
REDIS_MAXMEMORY=1gb
REDIS_MAXMEMORY_POLICY=allkeys-lru

# ======================
# METABASE API CONFIGURATION
# ======================
METABASE_URL=https://metabase.ofood.cloud
METABASE_USERNAME=a.mehmandoost@OFOOD.CLOUD
METABASE_PASSWORD=Fff322666@
METABASE_TEAM=growth

# Question IDs for data fetching
ORDER_DATA_QUESTION_ID=5822
VENDOR_DATA_QUESTION_ID=5045

# ======================
# CELERY CONFIGURATION
# ======================
CELERY_BROKER_URL=redis://${REDIS_HOST}:${REDIS_PORT}/1
CELERY_RESULT_BACKEND=redis://${REDIS_HOST}:${REDIS_PORT}/2
CELERY_TIMEZONE=Asia/Tehran
CELERY_ENABLE_UTC=True

# Worker settings
CELERY_WORKER_PROCESSES=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000
CELERY_TASK_SOFT_TIME_LIMIT=3600
CELERY_TASK_TIME_LIMIT=7200

# ======================
# WEB SERVER CONFIGURATION
# ======================
HOST=0.0.0.0
PORT=8000
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_CONNECTIONS=1000
MAX_REQUESTS=10000
MAX_REQUESTS_JITTER=1000
TIMEOUT=120
KEEPALIVE=5

# ======================
# SECURITY SETTINGS
# ======================
ALLOWED_HOSTS=localhost,127.0.0.1,your-domain.com
CORS_ORIGINS=http://localhost,https://your-domain.com
SSL_REDIRECT=False
SECURE_COOKIES=True

# API rate limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# ======================
# LOGGING CONFIGURATION
# ======================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_ENABLED=True
LOG_FILE_PATH=/app/logs/application.log
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_BACKUP_COUNT=5

# Structured logging
ENABLE_STRUCTURED_LOGGING=True
LOG_SQL_QUERIES=False

# ======================
# MONITORING & ALERTING
# ======================
# Sentry (Error tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus metrics
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=9090

# Health check settings
HEALTH_CHECK_ENABLED=True
HEALTH_CHECK_INTERVAL=30

# ======================
# CACHE CONFIGURATION
# ======================
CACHE_DEFAULT_TIMEOUT=3600
CACHE_KEY_PREFIX=tapsifood_dashboard
CACHE_COMPRESSION_ENABLED=True
CACHE_COMPRESSION_THRESHOLD=1024

# Cache TTL settings (in seconds)
CACHE_TTL_INITIAL_DATA=21600      # 6 hours
CACHE_TTL_MAP_DATA=3600           # 1 hour
CACHE_TTL_FILTERED_DATA=1800      # 30 minutes
CACHE_TTL_HEATMAP_DATA=3600       # 1 hour
CACHE_TTL_HEALTH_STATUS=300       # 5 minutes

# ======================
# DATA PROCESSING
# ======================
# Heatmap processing
HEATMAP_AUTO_OPTIMIZE=True
HEATMAP_MAX_POINTS=50000
HEATMAP_AGGREGATION_PRECISION=4

# Coverage grid settings
COVERAGE_GRID_SIZE_METERS=200
COVERAGE_GRID_MAX_POINTS=10000
COVERAGE_CACHE_TTL=7200           # 2 hours

# Data refresh settings
DATA_REFRESH_HOUR=9               # 9 AM
DATA_REFRESH_TIMEZONE=Asia/Tehran
AUTO_CACHE_WARM=True

# ======================
# FILE STORAGE
# ======================
STATIC_ROOT=/app/static
MEDIA_ROOT=/app/media
UPLOAD_MAX_SIZE=10MB

# Data directories
DATA_DIR=/app/data
POLYGONS_DIR=/app/data/polygons
VENDOR_DATA_DIR=/app/data/vendor
TARGETS_DIR=/app/data/targets

# ======================
# BACKUP CONFIGURATION
# ======================
BACKUP_ENABLED=True
BACKUP_DIRECTORY=/app/backups
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"       # Daily at 2 AM

# S3 backup (optional)
S3_BACKUP_ENABLED=False
S3_BACKUP_BUCKET=tapsifood-backups
S3_ACCESS_KEY_ID=your-aws-access-key
S3_SECRET_ACCESS_KEY=your-aws-secret-key
S3_REGION=us-west-2

# ======================
# EMAIL CONFIGURATION (for alerts)
# ======================
EMAIL_ENABLED=False
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@domain.com
EMAIL_HOST_PASSWORD=your-email-password

# Alert email recipients
ALERT_EMAIL_RECIPIENTS=admin@yourdomain.com,devops@yourdomain.com

# ======================
# SLACK INTEGRATION (for alerts)
# ======================
SLACK_ENABLED=False
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#alerts
SLACK_USERNAME=TapsiFood Dashboard

# ======================
# EXTERNAL SERVICES
# ======================
# CDN settings
CDN_ENABLED=False
CDN_URL=https://cdn.yourdomain.com

# Analytics
ANALYTICS_ENABLED=False
GOOGLE_ANALYTICS_ID=UA-XXXXXXXX-X

# ======================
# DEVELOPMENT OVERRIDES
# ======================
# These settings are ignored in production but useful for development
DEV_DB_HOST=localhost
DEV_REDIS_HOST=localhost
DEV_CORS_ALLOW_ALL=True
DEV_DEBUG_TOOLBAR=False

# ======================
# FEATURE FLAGS
# ======================
FEATURE_COVERAGE_GRID=True
FEATURE_ADVANCED_HEATMAPS=True
FEATURE_REAL_TIME_UPDATES=True
FEATURE_EXPORT_DATA=True
FEATURE_ADMIN_PANEL=True

# ======================
# PERFORMANCE TUNING
# ======================
# Database query optimization
DB_QUERY_CACHE_SIZE=1000
DB_QUERY_TIMEOUT=30

# API response optimization
API_RESPONSE_COMPRESSION=True
API_PAGINATION_MAX_SIZE=5000
API_DEFAULT_PAGE_SIZE=1000

# Background job optimization
CELERY_TASK_COMPRESSION=gzip
CELERY_RESULT_COMPRESSION=gzip
CELERY_TASK_SERIALIZER=pickle
CELERY_RESULT_SERIALIZER=pickle

# ======================
# DOCKER CONFIGURATION
# ======================
COMPOSE_PROJECT_NAME=tapsifood-dashboard
COMPOSE_FILE=docker-compose.prod.yml

# Container resource limits
WEB_MEMORY_LIMIT=512m
WORKER_MEMORY_LIMIT=1g
DB_MEMORY_LIMIT=2g
REDIS_MEMORY_LIMIT=1g

# Container restart policy
RESTART_POLICY=unless-stopped

# ======================
# SSL/TLS CONFIGURATION
# ======================
SSL_ENABLED=False
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_DHPARAM_PATH=/etc/nginx/ssl/dhparam.pem

# Let's Encrypt (if using certbot)
LETSENCRYPT_EMAIL=admin@yourdomain.com
LETSENCRYPT_DOMAIN=yourdomain.com

# ======================
# CUSTOM CONFIGURATION
# ======================
# Add any custom environment variables here
CUSTOM_SETTING_1=value1
CUSTOM_SETTING_2=value2